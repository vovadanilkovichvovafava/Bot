import{u as de,a as ce,c as oe,r as f,f as V,j as e,F as me}from"./index-BalcLfRT.js";const xe="value_bet_used",M=[39,140,135,78,61,2,3,848,88,94,203,144,235,40,41,253,262,71,128];function ue(i){return i>0?1/parseFloat(i)*100:0}function P(i,a){const d=ue(a);return i-d}function pe(){const i=de(),{t:a}=ce(),{user:d}=oe(),[r,m]=f.useState([]),[F,k]=f.useState(!0),[c,B]=f.useState("all"),[o,v]=f.useState({current:0,total:0,phase:""}),x=d==null?void 0:d.is_premium;f.useEffect(()=>{x||localStorage.setItem(xe,"true")},[x]),f.useEffect(()=>{N()},[]);const N=async()=>{try{v({current:0,total:0,phase:a("valueFinder.loadingMatches")});const t=new Date().toISOString().split("T")[0],j=(await V.getFixturesByDate(t)).filter(s=>["NS","1H","2H","HT"].includes(s.fixture.status.short)),X=j.filter(s=>M.includes(s.league.id)),ee=j.filter(s=>!M.includes(s.league.id)),b=[...X.slice(0,30),...ee.slice(0,15)];v({current:0,total:b.length,phase:a("valueFinder.analyzingMatches")});const C=[],L=5;for(let s=0;s<b.length;s+=L){const y=b.slice(s,s+L),se=await Promise.allSettled(y.map(async g=>{var O,W,R,U,G,K,Y,Z,q,J;const[E,A]=await Promise.allSettled([V.getPrediction(g.fixture.id),V.getOdds(g.fixture.id)]),u=E.status==="fulfilled"?E.value:null,S=A.status==="fulfilled"?A.value:[];if(!((O=u==null?void 0:u.predictions)!=null&&O.percent))return null;const p=(R=(W=S==null?void 0:S[0])==null?void 0:W.bookmakers)==null?void 0:R[0],w=(U=p==null?void 0:p.bets)==null?void 0:U.find(n=>n.name==="Match Winner");if(!w)return null;const T=(K=(G=w.values)==null?void 0:G.find(n=>n.value==="Home"))==null?void 0:K.odd,I=(Z=(Y=w.values)==null?void 0:Y.find(n=>n.value==="Draw"))==null?void 0:Z.odd,$=(J=(q=w.values)==null?void 0:q.find(n=>n.value==="Away"))==null?void 0:J.odd;if(!T)return null;const z=parseInt(u.predictions.percent.home),D=parseInt(u.predictions.percent.draw),_=parseInt(u.predictions.percent.away),ae=P(z,T),re=P(D,I),le=P(_,$),H=[{type:"Home",pred:z,odd:T,value:ae,team:g.teams.home.name},{type:"Draw",pred:D,odd:I,value:re,team:"Draw"},{type:"Away",pred:_,odd:$,value:le,team:g.teams.away.name}],ne=H.reduce((n,Q)=>n.value>Q.value?n:Q),ie=M.includes(g.league.id);return{fixture:g,prediction:u,bookmaker:p==null?void 0:p.name,bets:H,bestBet:ne,isTopLeague:ie}}));C.push(...se),v({current:Math.min(s+L,b.length),total:b.length,phase:a("valueFinder.analyzingMatches")})}const te=C.filter(s=>s.status==="fulfilled"&&s.value!==null).map(s=>s.value).filter(s=>s.bestBet.value>0).sort((s,y)=>s.isTopLeague&&!y.isTopLeague?-1:!s.isTopLeague&&y.isTopLeague?1:y.bestBet.value-s.bestBet.value);m(te)}catch(t){console.error("Value finder error:",t)}finally{k(!1)}},l=c==="all"?r:c==="high"?r.filter(t=>t.bestBet.value>=10):r.filter(t=>t.bestBet.value>=5&&t.bestBet.value<10);return e.jsx("div",{className:"h-screen flex flex-col bg-[#F0F2F5]",children:e.jsxs("div",{className:"flex-1 min-h-0 overflow-y-auto",children:[e.jsxs("div",{className:"bg-white px-5 pt-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>i(-1),className:"w-10 h-10 flex items-center justify-center -ml-2",children:e.jsx("svg",{className:"w-6 h-6 text-gray-900",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})})}),e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:a("valueFinder.title")}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl p-4 text-white mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),e.jsx("span",{className:"font-bold",children:a("valueFinder.howItWorks")})]}),e.jsx("p",{className:"text-sm text-white/90",children:a("valueFinder.howItWorksDescription")})]}),e.jsx("div",{className:"flex gap-2",children:[{key:"all",label:a("valueFinder.filterAll")},{key:"high",label:a("valueFinder.filterHigh")},{key:"medium",label:a("valueFinder.filterMedium")}].map(t=>e.jsx("button",{onClick:()=>B(t.key),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${c===t.key?"bg-primary-600 text-white":"bg-gray-100 text-gray-600"}`,children:t.label},t.key))})]}),e.jsx("div",{className:"px-5 mt-4 space-y-3 pb-8",children:F?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(me,{size:"sm"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:o.phase}),o.total>0&&e.jsxs("p",{className:"text-sm text-gray-500",children:[o.current," / ",o.total," ",a("valueFinder.matches")]})]})]}),o.total>0&&e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-400 to-emerald-500 transition-all duration-300",style:{width:`${o.current/o.total*100}%`}})})]}),[1,2,3].map(t=>e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"shimmer h-5 w-40 mb-3"}),e.jsx("div",{className:"shimmer h-4 w-full mb-2"}),e.jsx("div",{className:"shimmer h-12 w-full rounded-xl"})]},t)),e.jsx("p",{className:"text-center text-gray-400 text-xs mt-4",children:a("valueFinder.priorityText")})]}):l.length===0?e.jsxs("div",{className:"card text-center py-10",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"none",stroke:"currentColor",strokeWidth:"1",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),e.jsx("p",{className:"font-medium text-gray-500",children:a("valueFinder.noValueBets")}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:a(c!=="all"?"valueFinder.tryChangingFilter":"valueFinder.checkBackLater")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-400",children:a("valueFinder.valueBetsFound",{count:l.length})}),l.some(t=>t.isTopLeague)&&e.jsx("p",{className:"text-xs text-amber-600 font-medium",children:a("valueFinder.fromTopLeagues",{count:l.filter(t=>t.isTopLeague).length})})]}),l.map((t,h)=>e.jsx(he,{item:t,navigate:i,t:a},h))]})})]})})}function he({item:i,navigate:a,t:d}){var N;const{fixture:r,bestBet:m,bets:F,bookmaker:k,prediction:c,isTopLeague:B}=i,o=new Date(r.fixture.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),v=r.league.name,x=m.value>=10;return e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm cursor-pointer hover:shadow-md transition-shadow",onClick:()=>a(`/match/${r.fixture.id}`),children:[e.jsx("div",{className:`h-1 ${x?"bg-gradient-to-r from-green-400 to-emerald-500":"bg-gradient-to-r from-amber-400 to-orange-500"}`}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:r.league.logo,alt:"",className:"w-4 h-4 object-contain"}),e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:v}),B&&e.jsx("span",{className:"text-[9px] font-bold bg-gradient-to-r from-amber-400 to-orange-500 text-white px-1.5 py-0.5 rounded",children:"TOP"})]}),e.jsx("span",{className:"text-xs font-medium text-gray-900 bg-gray-100 px-2 py-0.5 rounded",children:o})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("img",{src:r.teams.home.logo,alt:"",className:"w-8 h-8 object-contain shrink-0"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:r.teams.home.name})]}),e.jsx("span",{className:"text-xs text-gray-400 font-medium px-3",children:"VS"}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0 justify-end",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate text-right",children:r.teams.away.name}),e.jsx("img",{src:r.teams.away.logo,alt:"",className:"w-8 h-8 object-contain shrink-0"})]})]}),e.jsx("div",{className:`rounded-xl p-3 mb-3 ${x?"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200":"bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wide text-gray-500 font-medium",children:d("valueFinder.bestValueBet")}),e.jsx("p",{className:"font-bold text-gray-900 text-lg",children:m.team}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:["AI: ",e.jsxs("strong",{className:"text-gray-900",children:[m.pred,"%"]})]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{className:"text-xs text-gray-600",children:["Odds: ",e.jsx("strong",{className:"text-gray-900",children:m.odd})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-2xl font-bold ${x?"text-green-600":"text-amber-600"}`,children:["+",m.value.toFixed(1),"%"]}),e.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-wide",children:d("valueFinder.valueEdge")})]})]})}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:F.map((l,t)=>{const h=l.value>0,j=l.type===m.type;return e.jsxs("div",{className:`rounded-xl py-2.5 px-2 text-center transition-all ${j?x?"bg-green-100 border-2 border-green-400":"bg-amber-100 border-2 border-amber-400":h?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-100"}`,children:[e.jsx("p",{className:"text-[10px] text-gray-500 font-medium",children:l.type}),e.jsx("p",{className:"text-base font-bold text-gray-900",children:l.odd}),e.jsx("p",{className:`text-xs font-semibold ${h?j?x?"text-green-700":"text-amber-700":"text-green-600":"text-gray-400"}`,children:h?`+${l.value.toFixed(1)}%`:`${l.value.toFixed(1)}%`})]},t)})}),((N=c==null?void 0:c.predictions)==null?void 0:N.advice)&&e.jsxs("div",{className:"flex items-start gap-2 bg-blue-50 rounded-lg p-2.5 mb-2",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"})}),e.jsx("p",{className:"text-xs text-blue-800",children:c.predictions.advice})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-100",children:[e.jsxs("p",{className:"text-[10px] text-gray-400",children:["Source: ",k]}),e.jsxs("div",{className:"flex items-center gap-1 text-primary-600",children:[e.jsx("span",{className:"text-xs font-medium",children:d("valueFinder.viewDetails")}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]})]})]})]})}export{pe as default};
