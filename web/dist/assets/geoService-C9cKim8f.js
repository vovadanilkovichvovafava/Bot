const n="http://localhost:3001";class s{constructor(){this.geoInfo=null,this.geoPromise=null}async getGeoInfo(){return this.geoInfo?this.geoInfo:this.geoPromise?this.geoPromise:(this.geoPromise=(async()=>{try{const e=await fetch(`${n}/api/geo`);if(!e.ok)throw new Error("Geo fetch failed");return this.geoInfo=await e.json(),this.geoInfo}catch(e){return console.error("[GeoService] Error fetching geo info:",e),{country:"UNKNOWN",isBlocked:!1,bookmakerAvailable:!0}}})(),this.geoPromise)}async isBlocked(){return(await this.getGeoInfo()).isBlocked}async getBookmakerLink(e,r="app"){try{const o=new URLSearchParams({userId:e,campaign:r}),t=await fetch(`${n}/api/bookmaker/link?${o}`);if(!t.ok)throw new Error("Failed to get bookmaker link");return t.json()}catch(o){return console.error("[GeoService] Error getting bookmaker link:",o),{success:!1,link:"https://1xbet.com",isBlocked:!1,error:o.message}}}async generateClickId(e,r="direct"){try{const o=new URLSearchParams({userId:e,source:r}),t=await fetch(`${n}/api/click?${o}`);if(!t.ok)throw new Error("Failed to generate click ID");return t.json()}catch(o){return console.error("[GeoService] Error generating click ID:",o),null}}async checkPremium(e){try{const r=await fetch(`${n}/api/premium/check/${e}`);if(!r.ok)throw new Error("Failed to check premium");return r.json()}catch(r){return console.error("[GeoService] Error checking premium:",r),{isPremium:!1}}}clearCache(){this.geoInfo=null,this.geoPromise=null}}const i=new s;export{i as g};
